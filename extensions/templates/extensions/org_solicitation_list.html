{% extends "organizations/base.html" %}

{% load org_tags %}
{% load static %}

{% block title %}{{ organization.name }} - Lista de Solicitações de Faixa de Ramais{% endblock %}

{% block org-content %}
<h2 class="ui dividing grey header">
  <i class="sticky note outline icon"></i> Solicitações de Faixa de Ramais
</h2>
<table class="ui selectable bottom attached compact table">
  <thead>
    <tr>
      <th>Faixas de Ramais</th>
      <th>Criado em</th>
      <th>Modificado em</th>
      <th>Status</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    {% for solicitation in solicitation_list %}
      <tr>
        <td>{{ solicitation.extension_range }}</td>
        <td data-label="created">{{ solicitation.created|date:"d/m/Y" }} às {{ solicitation.created|time:"H:i" }}</td>
        <td data-label="modified">{{ solicitation.modified|date:"d/m/Y" }} às {{ solicitation.modified|time:"H:i" }}</td>
        <td data-label="status">
          {% include 'extensions/solicitation_status_label.html' with status=solicitation.status %}
        </td>
        <td class="collapsing">
        {% if solicitation.status == 1 %} {# SOLICITATION_OPENED #}
          <form action="{% url 'extensions:org_solicitation_update' solicitation.organization.slug solicitation.pk %}" method="post">
            {% csrf_token %}
            <input name='status' value='3' type='hidden'>  {# SOLICITATION_CANCELED #}
            <button class="ui inverted red button" type="submit">
              <i class="ban icon"></i> Cancelar
            </button>
          </form>
          {% endif %}
        </td>
      </tr>
    {% empty %}
      {% include "utils/empty-tbody.html" with search=request.GET.search %}
    {% endfor %}
  </tbody>
  <tfoot>
    <tr>
      <th colspan="3">
        {% if is_paginated %}
          {% include "utils/pagination.html" with page_obj=page_obj paginator=paginator page_range=page_range %}
        {% endif %}
      </th>
      <th colspan="2">
        <div class="ui grid">
          <div class="right aligned right floated column">
            <div class="ui label">
              TOTAL
              <div class="detail">{{ paginator.count }}</div>
            </div>
          </div>
        </div>
      </th>
    </tr>
  </tfoot>
</table>

<h2 class="ui dividing grey header">
  <i class="sticky note outline icon"></i> Solicitações de Faixa de Ramais dos Clientes
</h2>
<table class="ui selectable bottom attached compact table">
  <thead>
    <tr>
      <th>Cliente</th>
      <th>Faixas de Ramais</th>
      <th>Status</th>
      <th>Criado em</th>
      <th>Modificado em</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    {% for solicitation in company_solicitation_list %}
      <tr>
        <td>{{ solicitation.company }}</td>
        <td>{{ solicitation.extension_range }}</td>
        <td data-label="status">
          {% include 'extensions/solicitation_status_label.html' with status=solicitation.status %}
        </td>
        <td data-label="created">{{ solicitation.created|date:"d/m/Y" }} às {{ solicitation.created|time:"H:i" }}</td>
        <td data-label="modified">{{ solicitation.modified|date:"d/m/Y" }} às {{ solicitation.modified|time:"H:i" }}</td>
        <td class="collapsing">
          <form action="{% url 'extensions:company_solicitation_update' organization.slug solicitation.company.slug solicitation.pk %}" method="post">
            {% csrf_token %}
            <input name='status' value='2' type='hidden'> {# SOLICITATION_APPROVED #}
            <button class="ui inverted green button" type="submit">
              <i class="check icon"></i> Aprovar
            </button>
          </form>
        </td>
        <td class="collapsing">
          <form action="{% url 'extensions:company_solicitation_update' organization.slug solicitation.company.slug solicitation.pk %}" method="post">
            {% csrf_token %}
            <input name='status' value='4' type='hidden'> {# SOLICITATION_CANCELED #}
            <button class="ui inverted red button" type="submit">
              <i class="ban icon"></i> Negar
            </button>
          </form>
        </td>
      </tr>
    {% empty %}
      {% include "utils/empty-tbody.html" with search=request.GET.search %}
    {% endfor %}
  </tbody>
  <tfoot>
    <tr>
      <th colspan="5">
        {% comment %} INFO paginação para essa lista não implementada
        {% if is_paginated %}
          {% include "utils/pagination.html" with page_obj=page_obj paginator=paginator page_range=page_range %}
        {% endif %}
        {% endcomment %}
      </th>
      <th colspan="2">
        <div class="ui grid">
          <div class="right aligned right floated column">
            <div class="ui label">
              TOTAL
              <div class="detail">{{ company_solicitation_list|length }}</div>
            </div>
          </div>
        </div>
      </th>
    </tr>
  </tfoot>
</table>
{% endblock %}